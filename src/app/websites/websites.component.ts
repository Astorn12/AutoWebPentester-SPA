import { AlertifyService } from './../_services/alertify.service';
import { WebsiteService } from './../_services/website.service';
import { Component, OnInit } from '@angular/core';
import { Website } from '../_model/website';

@Component({
  selector: 'app-websites',
  templateUrl: './websites.component.html',
  styleUrls: ['./websites.component.css']
})
export class WebsitesComponent implements OnInit {
  allWebSites : Website[];
  recentWebSites: Website[];
  
  currentWebsite: Website;
  

  constructor(private webSiteService : WebsiteService,private alertify: AlertifyService) {

   }

  ngOnInit() {
    this.loadAllUsersWebSites();
    this.loadRecentUsersWebSites();
  }
  loadRecentUsersWebSites() {
    this.webSiteService.getRecent().subscribe((resentWebSites: Website[])=>{
      this.recentWebSites=resentWebSites;
    },error=>{
      this.alertify.error(error);
    });

  }
  loadAllUsersWebSites() {
    this.webSiteService.getAll().subscribe((webSites: Website[])=>{
      this.allWebSites=webSites;
    },error=>{
      this.alertify.error(error);
    });
}

  addWebSite(form :any){
    this.webSiteService.addWebSite(form.value).subscribe((response)=>{
      this.loadAllUsersWebSites();
      this.loadRecentUsersWebSites();
    },error=>{
      this.alertify.error(error);
    })
  }


  setCurrentWebSite(website: Website){
    this.currentWebsite=website;
  }
}
